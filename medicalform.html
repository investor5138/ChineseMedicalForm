<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>中醫問診表單</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
  <style>
    /* 自定義字體和樣式 */
    body {
      font-family: 'Noto Sans TC', sans-serif; /* 使用 Google Fonts 的中文字體 */
      line-height: 1.6;
      color: #333;
    }
    h2, h3 {
      color: #2c3e50;
    }
    #resultContainer {
      padding: 20px;
      border: 1px solid #ddd;
      background-color: #f9f9f9;
      margin-top: 20px;
    }
    #resultContent p {
      margin: 10px 0;
      font-size: 16px;
    }
  	button {
  	  background-color: #4CAF50; /* 按鈕背景顏色 */
  	  color: white; /* 文字顏色 */
  	  padding: 13.5px 27px; /* 原來的 90% */
  	  border: none; /* 移除邊框 */
  	  border-radius: 5px; /* 圓角 */
  	  font-size: 14.4px; /* 原來的 90% */
  	  cursor: pointer; /* 鼠標懸停時顯示手指圖標 */
  	  transition: background-color 0.3s ease; /* 背景顏色過渡效果 */
  	}  
  	button:hover {
  	  background-color: #45a049; /* 鼠標懸停時的背景顏色 */
  	}    
  </style>
  <!-- 引入 Google Fonts 的中文字體 -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>


<h2>中醫問診表單</h2>

<form id="medicalForm">
  <label for="symptoms">1. 食欲：</label>
  <input type="checkbox" name="symptoms" value="好">好
  <input type="checkbox" name="symptoms" value="不易餓">不易餓
  <input type="checkbox" name="symptoms" value="容易餓">容易餓
  <input type="checkbox" name="symptoms" value="總是不想吃">餓却不想吃
  <br><br>

  <label for="mental">2. 精神：</label>
  <input type="checkbox" name="mental" value="總是疲倦">總是疲倦
  <input type="checkbox" name="mental" value="好">好
  <input type="checkbox" name="mental" value="飯後疲倦">飯後疲倦
  <input type="checkbox" name="mental" value="嗜睡">嗜睡
  <br><br>
    
  <label for="sleep">3. 睡眠：</label>
  <input type="checkbox" name="sleep" value="失眠">失眠
  <input type="checkbox" name="sleep" value="多夢">多夢
  <input type="checkbox" name="sleep" value="半夜醒了不易再入睡">半夜醒了不易再入睡
  <input type="checkbox" name="sleep" value="淺眠">淺眠
  <input type="checkbox" name="sleep" value="日夜顛倒">日夜顛倒  
  <br><br>
  
  <label for="stool">4. 大號：</label>
  <input type="checkbox" name="stool" value="成形">成形
  <input type="checkbox" name="stool" value="不成形">不成形
  <input type="checkbox" name="stool" value="易腹瀉">易腹瀉
  <input type="checkbox" name="stool" value="便秘">便秘
  <input type="checkbox" name="stool" value="依賴瀉藥">依賴瀉藥
  <input type="checkbox" name="stool" value="乾燥">乾燥  
  <br><br>
  
  <label for="urine">5. 小便：</label>
  <input type="checkbox" name="urine" value="尿黃">尿黃
  <input type="checkbox" name="urine" value="白濁">白濁
  <input type="checkbox" name="urine" value="泡沫">泡沫
  <input type="checkbox" name="urine" value="尿少">尿少
  <input type="checkbox" name="urine" value="尿多">尿多
  <input type="checkbox" name="urine" value="尿頻">尿頻
  <input type="checkbox" name="urine" value="夜尿">夜尿  
  <br><br>
    
  <label for="drinking">6. 飲水習慣：</label>
  <input type="checkbox" name="drinking" value="喜喝冷水">喜喝冷水
  <input type="checkbox" name="drinking" value="喜喝熱水">喜喝熱水
  <input type="checkbox" name="drinking" value="喜歡大量喝水">喜歡大量喝水
  <input type="checkbox" name="drinking" value="嗜有糖冷飲">嗜有糖冷飲
  <br><br>  
  
  <label for="eating">7. 飲食習慣：</label>
  <input type="checkbox" name="eating" value="嗜辛辣">辛辣
  <input type="checkbox" name="eating" value="嗜甜食">嗜甜食
  <input type="checkbox" name="eating" value="怕辣">怕辣
  <input type="checkbox" name="eating" value="清淡">清淡
  <input type="checkbox" name="eating" value="喜熱湯">喜熱湯
  <br><br>
  
  <label for="head">8. 頭部：</label>
  <input type="checkbox" name="head" value="暈眩">暈眩
  <input type="checkbox" name="head" value="痛在兩側">痛在兩側
  <input type="checkbox" name="head" value="痛在後腦勺">痛在後腦勺
  <input type="checkbox" name="head" value="前額痛">前額痛
  <input type="checkbox" name="head" value="頭頂痛">頭頂痛
  <br><br>
  
  <label for="scalp">9. 頭皮：</label>
  <input type="checkbox" name="scalp" value="頭皮易出油">頭皮易出油
  <input type="checkbox" name="scalp" value="頭皮屑較多">頭皮屑較多
  <input type="checkbox" name="scalp" value="頭皮乾癢">頭皮乾癢
  <input type="checkbox" name="scalp" value="髮質粗糙乾燥">髮質粗糙乾燥
  <br><br>
    
  <label for="eye">10. 眼睛：</label>
  <input type="checkbox" name="eye" value="眼白有血絲">眼白有血絲
  <input type="checkbox" name="eye" value="乾澀">乾澀
  <input type="checkbox" name="eye" value="有霧">有霧
  <input type="checkbox" name="eye" value="易癢">易癢
  <input type="checkbox" name="eye" value="會痛">會痛
  <input type="checkbox" name="eye" value="易流淚">易流淚
  <br><br>  
  
  <label for="oral">11. 口腔：</label>
  <input type="checkbox" name="oral" value="口渴且喝很多水">口渴且喝很多水
  <input type="checkbox" name="oral" value="早上口苦">早上口苦
  <input type="checkbox" name="oral" value="經常口苦">經常口苦
  <input type="checkbox" name="oral" value="經常口臭">經常口臭
  <input type="checkbox" name="oral" value="牙齦腫脹">牙齦腫脹
  <input type="checkbox" name="oral" value="口渴但不想喝水">口渴但不想喝水
  <input type="checkbox" name="oral" value="口乾唇乾">口乾唇乾
  <input type="checkbox" name="oral" value="容易蛀牙">容易蛀牙  
  <br><br>  
  
  <label for="phlegm">12. 痰涕：</label>
  <input type="checkbox" name="phlegm" value="有痰">有痰
  <input type="checkbox" name="phlegm" value="無痰">無痰
  <input type="checkbox" name="phlegm" value="濃黃痰涕">濃黃痰涕
  <input type="checkbox" name="phlegm" value="濃白痰涕">濃白痰涕
  <input type="checkbox" name="phlegm" value="清痰">清痰
  <input type="checkbox" name="phlegm" value="泡沬清痰">泡沬清痰
  <br><br>  

  <label for="chest">13. 胸腔：</label>
  <input type="checkbox" name="chest" value="胸口悶痛">胸口悶痛
  <input type="checkbox" name="chest" value="肋骨痛">肋骨痛
  <input type="checkbox" name="chest" value="心絞痛">心絞痛
  <input type="checkbox" name="chest" value="前胸穿後背痛">前胸穿後背痛
  <input type="checkbox" name="chest" value="心悸">心悸
  <input type="checkbox" name="chest" value="脈搏經常85以上">脈搏經常85以上
  <br><br>  

  <label for="back">14. 背部：</label>
  <input type="checkbox" name="back" value="背痛">背痛
  <input type="checkbox" name="back" value="肩痛">肩痛
  <input type="checkbox" name="back" value="背部有寒冷感">背部有寒冷感
  <input type="checkbox" name="back" value="後頸部痛">後頸部痛
  <br><br>  

  <label for="spleen">15. 脾胃：</label>
  <input type="checkbox" name="spleen" value="易痛">易痛
  <input type="checkbox" name="spleen" value="胃酸">胃酸
  <input type="checkbox" name="spleen" value="易脹">易脹
  <input type="checkbox" name="spleen" value="想吐">想吐
  <input type="checkbox" name="spleen" value="打嗝">打嗝
  <input type="checkbox" name="spleen" value="胃食道逆流">胃食道逆流
  <br><br>  

  <label for="waist">16. 腰部：</label>
  <input type="checkbox" name="waist" value="腰痠">腰痠
  <input type="checkbox" name="waist" value="腰痛">腰痛
  <input type="checkbox" name="waist" value="下身無力">下身無力
  <input type="checkbox" name="waist" value="彎腰困難">彎腰困難
  <br><br>  


  <label for="footleg">17. 腳腿：</label>
  <input type="checkbox" name="footleg" value="腿無力">腿無力
  <input type="checkbox" name="footleg" value="膝蓋無力">膝蓋無力
  <input type="checkbox" name="footleg" value="大腿水腫">大腿水腫
  <input type="checkbox" name="footleg" value="小腿水腫">小腿水腫
  <input type="checkbox" name="footleg" value="易抽筋">易抽筋
  <br><br>  

  <label for="mc">18. 月事：</label>
  <input type="checkbox" name="mc" value="色淡">色淡
  <input type="checkbox" name="mc" value="色暗">色暗
  <input type="checkbox" name="mc" value="量多">量多
  <input type="checkbox" name="mc" value="量少">量少
  <input type="checkbox" name="mc" value="有血塊">有血塊
  <input type="checkbox" name="mc" value="總是經痛">總是經痛
  <input type="checkbox" name="mc" value="未滿50歲停經">未滿50歲停經
  <input type="checkbox" name="mc" value="天數總是多於7天">天數總是多於7天
  <input type="checkbox" name="mc" value="天數總是少於3天">天數總是少於3天
  <br><br>  

  <label for="hotcold">19. 冷熱：</label>
  <input type="checkbox" name="hotcold" value="怕冷">怕冷
  <input type="checkbox" name="hotcold" value="怕熱">怕熱
  <input type="checkbox" name="hotcold" value="怕風">怕風
  <input type="checkbox" name="hotcold" value="手冷">手冷
  <input type="checkbox" name="hotcold" value="腳冷">腳冷
  <input type="checkbox" name="hotcold" value="手心熱">手心熱
  <input type="checkbox" name="hotcold" value="上身熱下身寒">上身熱下身寒
  <input type="checkbox" name="hotcold" value="上身寒下身熱">上身寒下身熱  
  <br><br>  

  <label for="sweat">20. 流汗：</label>
  <input type="checkbox" name="sweat" value="易出汗">易出汗
  <input type="checkbox" name="sweat" value="多汗">多汗
  <input type="checkbox" name="sweat" value="少汗">少汗
  <input type="checkbox" name="sweat" value="額頭冒冷汗">額頭冒冷汗
  <input type="checkbox" name="sweat" value="背部盜汗">背部盜汗
  <br><br>    

  <button type="button" onclick="generatePDF()">提交</button>
</form>

<div id="resultContainer" style="display:none;">
  <h3>填寫結果</h3>
  <div id="resultContent"></div>
</div>

<script>
  function generatePDF() {
    // 表單項目的映射名稱
    const labels = {
      symptoms: '1. 食欲：',
      mental: '2. 精神：',
      sleep: '3. 睡眠：',
      stool: '4. 大號：',
      urine: '5. 小便：',
      drinking: '6. 飲水習慣：',
      eating: '7. 飲食習慣：',
      head: '8. 頭部：',
      scalp: '9. 頭皮：',
      eye: '10. 眼睛：',
      oral: '11. 口腔：',
      phlegm: '12. 痰涕：',
      chest: '13. 胸腔：',
      back: '14. 背部：',
      spleen: '15. 脾胃：',
      waist: '16. 腰部：',
      footleg: '17. 腳腿：',
      mc: '18. 月事：',
      hotcold: '19. 冷熱：',
      sweat: '20. 流汗：'
    };

    // 獲取表單數據
    const formData = new FormData(document.getElementById("medicalForm"));
    let resultContent = document.getElementById("resultContent");
    resultContent.innerHTML = ""; // 清空之前的結果

    // 用於存儲每一題的答案
    const answers = {};

    // 將同一題的多個選項合併成一個字串
    formData.forEach((value, key) => {
      if (!answers[key]) {
        answers[key] = [];
      }
      answers[key].push(value);
    });

    // 填充選中的表單項目到結果容器中
    Object.keys(answers).forEach(key => {
      const p = document.createElement("p");
      // 使用 labels 映射將 `name` 屬性轉換為中文
      p.innerHTML = `<strong>${labels[key] || key}</strong> ${answers[key].join('；')}`;
      resultContent.appendChild(p);
    });

    // 顯示結果容器
    document.getElementById("resultContainer").style.display = "block";

    // 使用 html2pdf 生成 PDF 並下載
    const element = document.getElementById("resultContainer");
    const opt = {
      margin: [10, 10, 10, 10], // 頁面邊距
      filename: '中醫問診結果.pdf', // 檔案名稱
      image: { type: 'jpeg', quality: 0.98 }, // 圖片質量
      html2canvas: { scale: 2 }, // 提高渲染解析度
      jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' } // A4 紙張，縱向
    };

    html2pdf().set(opt).from(element).save();
  }
</script>

</body>
</html>
